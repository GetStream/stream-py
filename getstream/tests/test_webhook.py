# Code generated by GetStream internal OpenAPI code generator. DO NOT EDIT.

import hmac
import hashlib

import warnings

import pytest

from getstream.webhook import (
    get_event_type,
    parse_webhook_event,
    verify_webhook_signature,
)


class TestVerifyWebhookSignature:
    def setup_method(self):
        self.secret = "test-webhook-secret"
        self.body = b'{"type":"test.event"}'
        self.valid_signature = hmac.new(
            self.secret.encode("utf-8"), self.body, hashlib.sha256
        ).hexdigest()

    def test_valid_signature(self):
        assert (
            verify_webhook_signature(self.body, self.valid_signature, self.secret)
            is True
        )

    def test_wrong_signature(self):
        assert (
            verify_webhook_signature(self.body, "invalidsignature", self.secret)
            is False
        )

    def test_tampered_body(self):
        assert (
            verify_webhook_signature(
                b'{"type":"tampered"}', self.valid_signature, self.secret
            )
            is False
        )

    def test_wrong_secret(self):
        assert (
            verify_webhook_signature(self.body, self.valid_signature, "wrong-secret")
            is False
        )

    def test_string_body(self):
        body_str = '{"type":"test.event"}'
        sig = hmac.new(
            self.secret.encode("utf-8"), body_str.encode("utf-8"), hashlib.sha256
        ).hexdigest()
        assert verify_webhook_signature(body_str, sig, self.secret) is True


class TestGetEventType:
    def test_from_string(self):
        assert get_event_type('{"type":"message.new"}') == "message.new"

    def test_from_bytes(self):
        assert get_event_type(b'{"type":"message.new"}') == "message.new"

    def test_from_dict(self):
        assert get_event_type({"type": "message.new"}) == "message.new"

    def test_missing_type(self):
        assert get_event_type('{"foo":"bar"}') == ""

    def test_invalid_json(self):
        assert get_event_type("not json") == ""

    def test_empty_object(self):
        assert get_event_type("{}") == ""


class TestParseWebhookEvent:
    def test_parse_(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "*"})
        assert type(event).__name__ == "CustomEvent"

    def test_parse_appeal_accepted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "appeal.accepted"})
        assert type(event).__name__ == "AppealAcceptedEvent"

    def test_parse_appeal_created(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "appeal.created"})
        assert type(event).__name__ == "AppealCreatedEvent"

    def test_parse_appeal_rejected(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "appeal.rejected"})
        assert type(event).__name__ == "AppealRejectedEvent"

    def test_parse_call_accepted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.accepted"})
        assert type(event).__name__ == "CallAcceptedEvent"

    def test_parse_call_blocked_user(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.blocked_user"})
        assert type(event).__name__ == "BlockedUserEvent"

    def test_parse_call_closed_caption(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.closed_caption"})
        assert type(event).__name__ == "ClosedCaptionEvent"

    def test_parse_call_closed_captions_failed(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.closed_captions_failed"})
        assert type(event).__name__ == "CallClosedCaptionsFailedEvent"

    def test_parse_call_closed_captions_started(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.closed_captions_started"})
        assert type(event).__name__ == "CallClosedCaptionsStartedEvent"

    def test_parse_call_closed_captions_stopped(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.closed_captions_stopped"})
        assert type(event).__name__ == "CallClosedCaptionsStoppedEvent"

    def test_parse_call_created(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.created"})
        assert type(event).__name__ == "CallCreatedEvent"

    def test_parse_call_deleted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.deleted"})
        assert type(event).__name__ == "CallDeletedEvent"

    def test_parse_call_dtmf(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.dtmf"})
        assert type(event).__name__ == "CallDTMFEvent"

    def test_parse_call_ended(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.ended"})
        assert type(event).__name__ == "CallEndedEvent"

    def test_parse_call_frame_recording_failed(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.frame_recording_failed"})
        assert type(event).__name__ == "CallFrameRecordingFailedEvent"

    def test_parse_call_frame_recording_ready(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.frame_recording_ready"})
        assert type(event).__name__ == "CallFrameRecordingFrameReadyEvent"

    def test_parse_call_frame_recording_started(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.frame_recording_started"})
        assert type(event).__name__ == "CallFrameRecordingStartedEvent"

    def test_parse_call_frame_recording_stopped(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.frame_recording_stopped"})
        assert type(event).__name__ == "CallFrameRecordingStoppedEvent"

    def test_parse_call_hls_broadcasting_failed(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.hls_broadcasting_failed"})
        assert type(event).__name__ == "CallHLSBroadcastingFailedEvent"

    def test_parse_call_hls_broadcasting_started(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.hls_broadcasting_started"})
        assert type(event).__name__ == "CallHLSBroadcastingStartedEvent"

    def test_parse_call_hls_broadcasting_stopped(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.hls_broadcasting_stopped"})
        assert type(event).__name__ == "CallHLSBroadcastingStoppedEvent"

    def test_parse_call_kicked_user(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.kicked_user"})
        assert type(event).__name__ == "KickedUserEvent"

    def test_parse_call_live_started(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.live_started"})
        assert type(event).__name__ == "CallLiveStartedEvent"

    def test_parse_call_member_added(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.member_added"})
        assert type(event).__name__ == "CallMemberAddedEvent"

    def test_parse_call_member_removed(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.member_removed"})
        assert type(event).__name__ == "CallMemberRemovedEvent"

    def test_parse_call_member_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.member_updated"})
        assert type(event).__name__ == "CallMemberUpdatedEvent"

    def test_parse_call_member_updated_permission(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.member_updated_permission"})
        assert type(event).__name__ == "CallMemberUpdatedPermissionEvent"

    def test_parse_call_missed(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.missed"})
        assert type(event).__name__ == "CallMissedEvent"

    def test_parse_call_moderation_blur(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.moderation_blur"})
        assert type(event).__name__ == "CallModerationBlurEvent"

    def test_parse_call_moderation_warning(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.moderation_warning"})
        assert type(event).__name__ == "CallModerationWarningEvent"

    def test_parse_call_notification(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.notification"})
        assert type(event).__name__ == "CallNotificationEvent"

    def test_parse_call_permission_request(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.permission_request"})
        assert type(event).__name__ == "PermissionRequestEvent"

    def test_parse_call_permissions_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.permissions_updated"})
        assert type(event).__name__ == "UpdatedCallPermissionsEvent"

    def test_parse_call_reaction_new(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.reaction_new"})
        assert type(event).__name__ == "CallReactionEvent"

    def test_parse_call_recording_failed(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.recording_failed"})
        assert type(event).__name__ == "CallRecordingFailedEvent"

    def test_parse_call_recording_ready(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.recording_ready"})
        assert type(event).__name__ == "CallRecordingReadyEvent"

    def test_parse_call_recording_started(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.recording_started"})
        assert type(event).__name__ == "CallRecordingStartedEvent"

    def test_parse_call_recording_stopped(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.recording_stopped"})
        assert type(event).__name__ == "CallRecordingStoppedEvent"

    def test_parse_call_rejected(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.rejected"})
        assert type(event).__name__ == "CallRejectedEvent"

    def test_parse_call_ring(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.ring"})
        assert type(event).__name__ == "CallRingEvent"

    def test_parse_call_rtmp_broadcast_failed(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.rtmp_broadcast_failed"})
        assert type(event).__name__ == "CallRtmpBroadcastFailedEvent"

    def test_parse_call_rtmp_broadcast_started(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.rtmp_broadcast_started"})
        assert type(event).__name__ == "CallRtmpBroadcastStartedEvent"

    def test_parse_call_rtmp_broadcast_stopped(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.rtmp_broadcast_stopped"})
        assert type(event).__name__ == "CallRtmpBroadcastStoppedEvent"

    def test_parse_call_session_ended(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.session_ended"})
        assert type(event).__name__ == "CallSessionEndedEvent"

    def test_parse_call_session_participant_count_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event(
                {"type": "call.session_participant_count_updated"}
            )
        assert type(event).__name__ == "CallSessionParticipantCountsUpdatedEvent"

    def test_parse_call_session_participant_joined(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.session_participant_joined"})
        assert type(event).__name__ == "CallSessionParticipantJoinedEvent"

    def test_parse_call_session_participant_left(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.session_participant_left"})
        assert type(event).__name__ == "CallSessionParticipantLeftEvent"

    def test_parse_call_session_started(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.session_started"})
        assert type(event).__name__ == "CallSessionStartedEvent"

    def test_parse_call_stats_report_ready(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.stats_report_ready"})
        assert type(event).__name__ == "CallStatsReportReadyEvent"

    def test_parse_call_transcription_failed(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.transcription_failed"})
        assert type(event).__name__ == "CallTranscriptionFailedEvent"

    def test_parse_call_transcription_ready(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.transcription_ready"})
        assert type(event).__name__ == "CallTranscriptionReadyEvent"

    def test_parse_call_transcription_started(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.transcription_started"})
        assert type(event).__name__ == "CallTranscriptionStartedEvent"

    def test_parse_call_transcription_stopped(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.transcription_stopped"})
        assert type(event).__name__ == "CallTranscriptionStoppedEvent"

    def test_parse_call_unblocked_user(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.unblocked_user"})
        assert type(event).__name__ == "UnblockedUserEvent"

    def test_parse_call_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.updated"})
        assert type(event).__name__ == "CallUpdatedEvent"

    def test_parse_call_user_feedback_submitted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.user_feedback_submitted"})
        assert type(event).__name__ == "CallUserFeedbackSubmittedEvent"

    def test_parse_call_user_muted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "call.user_muted"})
        assert type(event).__name__ == "CallUserMutedEvent"

    def test_parse_campaign_completed(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "campaign.completed"})
        assert type(event).__name__ == "CampaignCompletedEvent"

    def test_parse_campaign_started(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "campaign.started"})
        assert type(event).__name__ == "CampaignStartedEvent"

    def test_parse_channel_created(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "channel.created"})
        assert type(event).__name__ == "ChannelCreatedEvent"

    def test_parse_channel_deleted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "channel.deleted"})
        assert type(event).__name__ == "ChannelDeletedEvent"

    def test_parse_channel_frozen(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "channel.frozen"})
        assert type(event).__name__ == "ChannelFrozenEvent"

    def test_parse_channel_hidden(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "channel.hidden"})
        assert type(event).__name__ == "ChannelHiddenEvent"

    def test_parse_channel_max_streak_changed(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "channel.max_streak_changed"})
        assert type(event).__name__ == "MaxStreakChangedEvent"

    def test_parse_channel_muted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "channel.muted"})
        assert type(event).__name__ == "ChannelMutedEvent"

    def test_parse_channel_truncated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "channel.truncated"})
        assert type(event).__name__ == "ChannelTruncatedEvent"

    def test_parse_channel_unfrozen(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "channel.unfrozen"})
        assert type(event).__name__ == "ChannelUnFrozenEvent"

    def test_parse_channel_unmuted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "channel.unmuted"})
        assert type(event).__name__ == "ChannelUnmutedEvent"

    def test_parse_channel_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "channel.updated"})
        assert type(event).__name__ == "ChannelUpdatedEvent"

    def test_parse_channel_visible(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "channel.visible"})
        assert type(event).__name__ == "ChannelVisibleEvent"

    def test_parse_channel_batch_update_completed(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "channel_batch_update.completed"})
        assert type(event).__name__ == "ChannelBatchCompletedEvent"

    def test_parse_channel_batch_update_started(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "channel_batch_update.started"})
        assert type(event).__name__ == "ChannelBatchStartedEvent"

    def test_parse_custom(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "custom"})
        assert type(event).__name__ == "CustomVideoEvent"

    def test_parse_export_bulk_image_moderation_error(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "export.bulk_image_moderation.error"})
        assert type(event).__name__ == "AsyncExportErrorEvent"

    def test_parse_export_bulk_image_moderation_success(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event(
                {"type": "export.bulk_image_moderation.success"}
            )
        assert type(event).__name__ == "AsyncBulkImageModerationEvent"

    def test_parse_export_channels_error(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "export.channels.error"})
        assert type(event).__name__ == "AsyncExportErrorEvent"

    def test_parse_export_channels_success(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "export.channels.success"})
        assert type(event).__name__ == "AsyncExportChannelsEvent"

    def test_parse_export_moderation_logs_error(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "export.moderation_logs.error"})
        assert type(event).__name__ == "AsyncExportErrorEvent"

    def test_parse_export_moderation_logs_success(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "export.moderation_logs.success"})
        assert type(event).__name__ == "AsyncExportModerationLogsEvent"

    def test_parse_export_users_error(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "export.users.error"})
        assert type(event).__name__ == "AsyncExportErrorEvent"

    def test_parse_export_users_success(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "export.users.success"})
        assert type(event).__name__ == "AsyncExportUsersEvent"

    def test_parse_feeds_activity_added(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.activity.added"})
        assert type(event).__name__ == "ActivityAddedEvent"

    def test_parse_feeds_activity_deleted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.activity.deleted"})
        assert type(event).__name__ == "ActivityDeletedEvent"

    def test_parse_feeds_activity_feedback(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.activity.feedback"})
        assert type(event).__name__ == "ActivityFeedbackEvent"

    def test_parse_feeds_activity_marked(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.activity.marked"})
        assert type(event).__name__ == "ActivityMarkEvent"

    def test_parse_feeds_activity_pinned(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.activity.pinned"})
        assert type(event).__name__ == "ActivityPinnedEvent"

    def test_parse_feeds_activity_reaction_added(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.activity.reaction.added"})
        assert type(event).__name__ == "ActivityReactionAddedEvent"

    def test_parse_feeds_activity_reaction_deleted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.activity.reaction.deleted"})
        assert type(event).__name__ == "ActivityReactionDeletedEvent"

    def test_parse_feeds_activity_reaction_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.activity.reaction.updated"})
        assert type(event).__name__ == "ActivityReactionUpdatedEvent"

    def test_parse_feeds_activity_removed_from_feed(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.activity.removed_from_feed"})
        assert type(event).__name__ == "ActivityRemovedFromFeedEvent"

    def test_parse_feeds_activity_restored(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.activity.restored"})
        assert type(event).__name__ == "ActivityRestoredEvent"

    def test_parse_feeds_activity_unpinned(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.activity.unpinned"})
        assert type(event).__name__ == "ActivityUnpinnedEvent"

    def test_parse_feeds_activity_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.activity.updated"})
        assert type(event).__name__ == "ActivityUpdatedEvent"

    def test_parse_feeds_bookmark_added(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.bookmark.added"})
        assert type(event).__name__ == "BookmarkAddedEvent"

    def test_parse_feeds_bookmark_deleted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.bookmark.deleted"})
        assert type(event).__name__ == "BookmarkDeletedEvent"

    def test_parse_feeds_bookmark_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.bookmark.updated"})
        assert type(event).__name__ == "BookmarkUpdatedEvent"

    def test_parse_feeds_bookmark_folder_deleted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.bookmark_folder.deleted"})
        assert type(event).__name__ == "BookmarkFolderDeletedEvent"

    def test_parse_feeds_bookmark_folder_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.bookmark_folder.updated"})
        assert type(event).__name__ == "BookmarkFolderUpdatedEvent"

    def test_parse_feeds_comment_added(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.comment.added"})
        assert type(event).__name__ == "CommentAddedEvent"

    def test_parse_feeds_comment_deleted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.comment.deleted"})
        assert type(event).__name__ == "CommentDeletedEvent"

    def test_parse_feeds_comment_reaction_added(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.comment.reaction.added"})
        assert type(event).__name__ == "CommentReactionAddedEvent"

    def test_parse_feeds_comment_reaction_deleted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.comment.reaction.deleted"})
        assert type(event).__name__ == "CommentReactionDeletedEvent"

    def test_parse_feeds_comment_reaction_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.comment.reaction.updated"})
        assert type(event).__name__ == "CommentReactionUpdatedEvent"

    def test_parse_feeds_comment_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.comment.updated"})
        assert type(event).__name__ == "CommentUpdatedEvent"

    def test_parse_feeds_feed_created(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.feed.created"})
        assert type(event).__name__ == "FeedCreatedEvent"

    def test_parse_feeds_feed_deleted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.feed.deleted"})
        assert type(event).__name__ == "FeedDeletedEvent"

    def test_parse_feeds_feed_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.feed.updated"})
        assert type(event).__name__ == "FeedUpdatedEvent"

    def test_parse_feeds_feed_group_changed(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.feed_group.changed"})
        assert type(event).__name__ == "FeedGroupChangedEvent"

    def test_parse_feeds_feed_group_deleted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.feed_group.deleted"})
        assert type(event).__name__ == "FeedGroupDeletedEvent"

    def test_parse_feeds_feed_member_added(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.feed_member.added"})
        assert type(event).__name__ == "FeedMemberAddedEvent"

    def test_parse_feeds_feed_member_removed(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.feed_member.removed"})
        assert type(event).__name__ == "FeedMemberRemovedEvent"

    def test_parse_feeds_feed_member_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.feed_member.updated"})
        assert type(event).__name__ == "FeedMemberUpdatedEvent"

    def test_parse_feeds_follow_created(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.follow.created"})
        assert type(event).__name__ == "FollowCreatedEvent"

    def test_parse_feeds_follow_deleted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.follow.deleted"})
        assert type(event).__name__ == "FollowDeletedEvent"

    def test_parse_feeds_follow_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.follow.updated"})
        assert type(event).__name__ == "FollowUpdatedEvent"

    def test_parse_feeds_notification_feed_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.notification_feed.updated"})
        assert type(event).__name__ == "NotificationFeedUpdatedEvent"

    def test_parse_feeds_stories_feed_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "feeds.stories_feed.updated"})
        assert type(event).__name__ == "StoriesFeedUpdatedEvent"

    def test_parse_flag_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "flag.updated"})
        assert type(event).__name__ == "FlagUpdatedEvent"

    def test_parse_ingress_error(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "ingress.error"})
        assert type(event).__name__ == "IngressErrorEvent"

    def test_parse_ingress_started(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "ingress.started"})
        assert type(event).__name__ == "IngressStartedEvent"

    def test_parse_ingress_stopped(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "ingress.stopped"})
        assert type(event).__name__ == "IngressStoppedEvent"

    def test_parse_member_added(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "member.added"})
        assert type(event).__name__ == "MemberAddedEvent"

    def test_parse_member_removed(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "member.removed"})
        assert type(event).__name__ == "MemberRemovedEvent"

    def test_parse_member_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "member.updated"})
        assert type(event).__name__ == "MemberUpdatedEvent"

    def test_parse_message_deleted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "message.deleted"})
        assert type(event).__name__ == "MessageDeletedEvent"

    def test_parse_message_flagged(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "message.flagged"})
        assert type(event).__name__ == "MessageFlaggedEvent"

    def test_parse_message_new(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "message.new"})
        assert type(event).__name__ == "MessageNewEvent"

    def test_parse_message_pending(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "message.pending"})
        assert type(event).__name__ == "PendingMessageEvent"

    def test_parse_message_read(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "message.read"})
        assert type(event).__name__ == "MessageReadEvent"

    def test_parse_message_unblocked(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "message.unblocked"})
        assert type(event).__name__ == "MessageUnblockedEvent"

    def test_parse_message_undeleted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "message.undeleted"})
        assert type(event).__name__ == "MessageUndeletedEvent"

    def test_parse_message_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "message.updated"})
        assert type(event).__name__ == "MessageUpdatedEvent"

    def test_parse_moderation_custom_action(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "moderation.custom_action"})
        assert type(event).__name__ == "ModerationCustomActionEvent"

    def test_parse_moderation_flagged(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "moderation.flagged"})
        assert type(event).__name__ == "ModerationFlaggedEvent"

    def test_parse_moderation_mark_reviewed(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "moderation.mark_reviewed"})
        assert type(event).__name__ == "ModerationMarkReviewedEvent"

    def test_parse_moderation_check_completed(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "moderation_check.completed"})
        assert type(event).__name__ == "ModerationCheckCompletedEvent"

    def test_parse_notification_mark_unread(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "notification.mark_unread"})
        assert type(event).__name__ == "NotificationMarkUnreadEvent"

    def test_parse_notification_reminder_due(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "notification.reminder_due"})
        assert type(event).__name__ == "ReminderNotificationEvent"

    def test_parse_notification_thread_message_new(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "notification.thread_message_new"})
        assert type(event).__name__ == "NotificationThreadMessageNewEvent"

    def test_parse_reaction_deleted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "reaction.deleted"})
        assert type(event).__name__ == "ReactionDeletedEvent"

    def test_parse_reaction_new(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "reaction.new"})
        assert type(event).__name__ == "ReactionNewEvent"

    def test_parse_reaction_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "reaction.updated"})
        assert type(event).__name__ == "ReactionUpdatedEvent"

    def test_parse_reminder_created(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "reminder.created"})
        assert type(event).__name__ == "ReminderCreatedEvent"

    def test_parse_reminder_deleted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "reminder.deleted"})
        assert type(event).__name__ == "ReminderDeletedEvent"

    def test_parse_reminder_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "reminder.updated"})
        assert type(event).__name__ == "ReminderUpdatedEvent"

    def test_parse_review_queue_item_new(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "review_queue_item.new"})
        assert type(event).__name__ == "ReviewQueueItemNewEvent"

    def test_parse_review_queue_item_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "review_queue_item.updated"})
        assert type(event).__name__ == "ReviewQueueItemUpdatedEvent"

    def test_parse_thread_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "thread.updated"})
        assert type(event).__name__ == "ThreadUpdatedEvent"

    def test_parse_user_banned(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "user.banned"})
        assert type(event).__name__ == "UserBannedEvent"

    def test_parse_user_deactivated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "user.deactivated"})
        assert type(event).__name__ == "UserDeactivatedEvent"

    def test_parse_user_deleted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "user.deleted"})
        assert type(event).__name__ == "UserDeletedEvent"

    def test_parse_user_flagged(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "user.flagged"})
        assert type(event).__name__ == "UserFlaggedEvent"

    def test_parse_user_messages_deleted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "user.messages.deleted"})
        assert type(event).__name__ == "UserMessagesDeletedEvent"

    def test_parse_user_muted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "user.muted"})
        assert type(event).__name__ == "UserMutedEvent"

    def test_parse_user_reactivated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "user.reactivated"})
        assert type(event).__name__ == "UserReactivatedEvent"

    def test_parse_user_unbanned(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "user.unbanned"})
        assert type(event).__name__ == "UserUnbannedEvent"

    def test_parse_user_unmuted(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "user.unmuted"})
        assert type(event).__name__ == "UserUnmutedEvent"

    def test_parse_user_unread_message_reminder(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "user.unread_message_reminder"})
        assert type(event).__name__ == "UserUnreadReminderEvent"

    def test_parse_user_updated(self):
        with warnings.catch_warnings():
            warnings.simplefilter("ignore", RuntimeWarning)
            event = parse_webhook_event({"type": "user.updated"})
        assert type(event).__name__ == "UserUpdatedEvent"

    def test_unknown_event_type(self):
        with pytest.raises(ValueError, match="Unknown webhook event type"):
            parse_webhook_event({"type": "unknown.event"})

    def test_missing_type_field(self):
        with pytest.raises(ValueError, match="missing 'type' field"):
            parse_webhook_event({"foo": "bar"})

    def test_invalid_json(self):
        with pytest.raises(ValueError, match="Failed to parse"):
            parse_webhook_event("not json")
